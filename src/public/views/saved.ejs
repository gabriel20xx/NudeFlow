<%- include("partials/header") %>
<main id="saved-container" class="page-wrapper" aria-label="Saved media">
    <h1 class="page-title">Saved</h1>
    <p class="muted mt-sm">Your bookmarked media appears here.</p>
    <section id="savedVideos" class="results-grid" aria-live="polite"></section>
</main>

    <script>
        async function fetchSavedVideos() {
            try {
                const response = await fetch('/api/saved');
                const apiResponse = await response.json();

                const container = document.getElementById('savedVideos');
                container.innerHTML = '';

                if (!apiResponse.success || !apiResponse.data || apiResponse.data.length === 0) {
                    container.innerHTML = '<p>No saved videos yet.</p>';
                    return;
                }

                apiResponse.data.forEach(video => {
                    const videoElement = document.createElement('div');
                    videoElement.classList.add('video-item');
                    videoElement.innerHTML = `
                        <div class="video-thumbnail">
                            <img src="${video.thumbnail || video.url}" alt="${video.name}" onclick="playVideo('${video.url}')">
                            <p>${video.name}</p>
                            <small>Category: ${video.category}</small>
                            <button onclick="removeSaved('${video.id}')">Remove</button>
                        </div>
                    `;
                    container.appendChild(videoElement);
                });
            } catch (error) {
                console.error('Error fetching saved videos:', error);
                document.getElementById('savedVideos').innerHTML = '<p>Error loading saved videos. Please try again.</p>';
            }
        }

        function playVideo(videoUrl) {
            window.location.href = `/?video=${encodeURIComponent(videoUrl)}`;
        }

        function removeSaved(videoId) {
            // This would need an API endpoint to remove saved videos
            alert('Remove saved video functionality not yet implemented');
        }

    fetchSavedVideos();
    </script>
<%- include("partials/navbar") %>
