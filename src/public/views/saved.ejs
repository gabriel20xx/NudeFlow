<%- include("partials/header") %>
<main id="saved-container" class="page-wrapper" aria-label="Saved media">
    <h1 class="page-title">Saved</h1>
    <p class="muted mt-sm">Your bookmarked media appears here.</p>
    <section id="savedVideos" class="results-grid" aria-live="polite"></section>
</main>

    <script>
        const SAVED_STORE_KEY = 'nf_savedMedia_v1';

        function getSavedList(){
            try { const raw = localStorage.getItem(SAVED_STORE_KEY); const arr = raw ? JSON.parse(raw) : []; return Array.isArray(arr)?arr:[]; } catch { return []; }
        }
        function saveSavedList(list){ try { localStorage.setItem(SAVED_STORE_KEY, JSON.stringify(list)); } catch{} }
        function removeSaved(id){ const next = getSavedList().filter(x=>x.id!==id); saveSavedList(next); renderSaved(); }
        function playVideo(url){ window.location.href = '/?video=' + encodeURIComponent(url); }

        function renderSaved(){
            const data = getSavedList();
            const container = document.getElementById('savedVideos');
            container.innerHTML = '';
            if(!data.length){ container.innerHTML = '<p>No saved videos yet.</p>'; return; }
            data.forEach(video => {
                const el = document.createElement('div');
                el.className = 'video-item';
                el.innerHTML = `
                    <div class="video-thumbnail">
                        <img src="${video.thumbnail || video.url}" alt="${video.name}">
                    </div>
                    <p>${video.name || 'Media'}</p>
                    <small>Category: ${video.category || ''}</small>
                    <div>
                        <button onclick="playVideo('${video.url}')">Open</button>
                        <button onclick="removeSaved('${video.id}')">Remove</button>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        renderSaved();
    </script>
<%- include("partials/navbar") %>
