<%- include("partials/header") %>
<%- include("partials/title") %>
 <div id="search-container">
        <input type="text" id="searchInput" placeholder="Search videos...">
        <button onclick="searchVideos()">Search</button>
    </div>

    <div id="searchResults"></div>

    <script>
        async function searchVideos() {
            try {
                const query = document.getElementById('searchInput').value;
                if (!query.trim()) {
                    document.getElementById('searchResults').innerHTML = '<p>Please enter a search query.</p>';
                    return;
                }

                const response = await fetch(`/api/search?q=${encodeURIComponent(query)}`);
                const apiResponse = await response.json();

                const resultsContainer = document.getElementById('searchResults');
                resultsContainer.innerHTML = '';

                if (!apiResponse.success || !apiResponse.data || apiResponse.data.length === 0) {
                    resultsContainer.innerHTML = '<p>No results found.</p>';
                    return;
                }

                apiResponse.data.forEach(video => {
                    const videoElement = document.createElement('div');
                    videoElement.classList.add('video-item');
                    videoElement.innerHTML = `
                        <div class="video-thumbnail">
                            <img src="${video.thumbnail || video.url}" alt="${video.name}" onclick="playVideo('${video.url}')">
                            <p>${video.name}</p>
                            <small>Category: ${video.category}</small>
                        </div>
                    `;
                    resultsContainer.appendChild(videoElement);
                });
            } catch (error) {
                console.error('Search error:', error);
                document.getElementById('searchResults').innerHTML = '<p>Error occurred while searching. Please try again.</p>';
            }
        }

        function playVideo(videoUrl) {
            window.location.href = `/?video=${encodeURIComponent(videoUrl)}`;
        }

        // Allow search on Enter key
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchVideos();
            }
        });
    </script>
<%- include("partials/navbar") %>
<%- include("partials/footer") %>
